import DropdownIcon from"../assets/icons/dropdown.svg";class Picker{constructor(e){this.select=e,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("click",e=>{this.container.classList.toggle("ql-expanded")}),this.select.addEventListener("change",this.update.bind(this))}buildItem(e){let t=document.createElement("span");return t.classList.add("ql-picker-item"),e.hasAttribute("value")&&t.setAttribute("data-value",e.getAttribute("value")),e.textContent&&t.setAttribute("data-label",e.textContent),t.addEventListener("click",e=>{this.selectItem(t,!0)}),t}buildLabel(){var e=document.createElement("span");return e.classList.add("ql-picker-label"),e.innerHTML=DropdownIcon,this.container.appendChild(e),e}buildOptions(){let l=document.createElement("span");l.classList.add("ql-picker-options"),[].slice.call(this.select.options).forEach(e=>{var t=this.buildItem(e);l.appendChild(t),e.hasAttribute("selected")&&this.selectItem(t)}),this.container.appendChild(l)}buildPicker(){[].slice.call(this.select.attributes).forEach(e=>{this.container.setAttribute(e.name,e.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}close(){this.container.classList.remove("ql-expanded")}selectItem(e,t=!1){var l=this.container.querySelector(".ql-selected");e!==l&&(null!=l&&l.classList.remove("ql-selected"),null!=e?(e.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(e.parentNode.children,e),e.hasAttribute("data-value")?this.label.setAttribute("data-value",e.getAttribute("data-value")):this.label.removeAttribute("data-value"),e.hasAttribute("data-label")?this.label.setAttribute("data-label",e.getAttribute("data-label")):this.label.removeAttribute("data-label"),t&&("function"==typeof Event?this.select.dispatchEvent(new Event("change")):"object"==typeof Event&&((l=document.createEvent("Event")).initEvent("change",!0,!0),this.select.dispatchEvent(l)),this.close())):(this.label.removeAttribute("data-value"),this.label.removeAttribute("data-label")))}update(){let e;-1<this.select.selectedIndex?(t=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex],e=this.select.options[this.select.selectedIndex],this.selectItem(t)):this.selectItem(null);var t=null!=e&&e!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",t)}}export default Picker;