var direction="ltr",assetPath="../../../app-assets/";"rtl"==$("html").data("textdirection")&&(direction="rtl"),"laravel"===$("body").attr("data-framework")&&(assetPath=$("body").attr("data-asset-path")),$(document).on("click",".fc-sidebarToggle-button",function(e){$(".app-calendar-sidebar, .body-content-overlay").addClass("show")}),$(document).on("click",".body-content-overlay",function(e){$(".app-calendar-sidebar, .body-content-overlay").removeClass("show")}),document.addEventListener("DOMContentLoaded",function(){var r,t,a,e=document.getElementById("calendar"),o=$(".event-sidebar"),n={Business:"primary",Holiday:"success",Personal:"danger",Family:"warning",ETC:"info"},i=$(".event-form"),l=$(".add-event-btn"),d=$(".btn-cancel"),s=$(".update-event-btn"),c=$(".btn-toggle-sidebar"),v=$("#title"),p=$("#select-label"),u=$("#start-date"),h=$("#end-date"),m=$("#event-url"),f=$("#event-guests"),g=$("#event-location"),b=$(".allDay-switch"),y=$(".select-all"),k=$(".calendar-events-filter"),C=$(".input-filter"),w=$(".btn-delete-event"),x=$("#event-description-editor");function D(e){return e.id?"<span class='bullet bullet-"+$(e.element).data("label")+" bullet-sm me-50'> </span>"+e.text:e.text}function P(e){return e.id?"<div class='d-flex flex-wrap align-items-center'><div class='avatar avatar-sm my-0 me-50'><span class='avatar-content'><img src='"+assetPath+"images/avatars/"+$(e.element).data("avatar")+"' alt='avatar' /></span></div>"+e.text+"</div>":e.text}function S(){$(".fc-sidebarToggle-button").empty().append(feather.icons.menu.toSvg({class:"ficon"}))}$(".add-event button").on("click",function(e){$(".event-sidebar").addClass("show"),$(".sidebar-left").removeClass("show"),$(".app-calendar .body-content-overlay").addClass("show")}),p.length&&p.wrap('<div class="position-relative"></div>').select2({placeholder:"Select value",dropdownParent:p.parent(),templateResult:D,templateSelection:D,minimumResultsForSearch:-1,escapeMarkup:function(e){return e}}),f.length&&f.wrap('<div class="position-relative"></div>').select2({placeholder:"Select value",dropdownParent:f.parent(),closeOnSelect:!1,templateResult:P,templateSelection:P,escapeMarkup:function(e){return e}}),u.length&&(t=u.flatpickr({enableTime:!0,altFormat:"Y-m-dTH:i:S",onReady:function(e,t,a){a.isMobile&&$(a.mobileInput).attr("step",null)}})),h.length&&(a=h.flatpickr({enableTime:!0,altFormat:"Y-m-dTH:i:S",onReady:function(e,t,a){a.isMobile&&$(a.mobileInput).attr("step",null)}}));var E=new FullCalendar.Calendar(e,{initialView:"dayGridMonth",events:function(e,t){a=[],$(".calendar-events-filter input:checked").each(function(){a.push($(this).attr("data-value"))});var a,n=a;t(selectedEvents=events.filter(function(e){return n.includes(e.extendedProps.calendar.toLowerCase())}))},editable:!0,dragScroll:!0,dayMaxEvents:2,eventResizableFromStart:!0,customButtons:{sidebarToggle:{text:"Sidebar"}},headerToolbar:{start:"sidebarToggle, prev,next, title",end:"dayGridMonth,timeGridWeek,timeGridDay,listMonth"},direction:direction,initialDate:new Date,navLinks:!0,eventClassNames:function({event:e}){return["bg-light-"+n[e._def.extendedProps.calendar]]},dateClick:function(e){e=moment(e.date).format("YYYY-MM-DD"),M(),o.modal("show"),l.removeClass("d-none"),s.addClass("d-none"),w.addClass("d-none"),u.val(e),h.val(e)},eventClick:function(e){(r=e.event).url&&(e.jsEvent.preventDefault(),window.open(r.url,"_blank")),o.modal("show"),l.addClass("d-none"),d.addClass("d-none"),s.removeClass("d-none"),w.removeClass("d-none"),v.val(r.title),t.setDate(r.start,!0,"Y-m-d"),!0===r.allDay?b.prop("checked",!0):b.prop("checked",!1),null!==r.end?a.setDate(r.end,!0,"Y-m-d"):a.setDate(r.start,!0,"Y-m-d"),o.find(p).val(r.extendedProps.calendar).trigger("change"),void 0!==r.extendedProps.location&&g.val(r.extendedProps.location),void 0!==r.extendedProps.guests&&f.val(r.extendedProps.guests).trigger("change"),void 0!==r.extendedProps.guests&&x.val(r.extendedProps.description),w.on("click",function(){r.remove(),o.modal("hide"),$(".event-sidebar").removeClass("show"),$(".app-calendar .body-content-overlay").removeClass("show")})},datesSet:function(){S()},viewDidMount:function(){S()}});function M(){h.val(""),m.val(""),u.val(""),v.val(""),g.val(""),b.prop("checked",!1),f.val("").trigger("change"),x.val("")}E.render(),S(),i.length&&i.validate({submitHandler:function(e,t){t.preventDefault(),i.valid()&&o.modal("hide")},title:{required:!0},rules:{"start-date":{required:!0},"end-date":{required:!0}},messages:{"start-date":{required:"Start Date is required"},"end-date":{required:"End Date is required"}}}),c.length&&c.on("click",function(){d.removeClass("d-none")}),$(l).on("click",function(){var e;i.valid()&&(e={id:E.getEvents().length+1,title:v.val(),start:u.val(),end:h.val(),startStr:u.val(),endStr:h.val(),display:"block",extendedProps:{location:g.val(),guests:f.val(),calendar:p.val(),description:x.val()}},m.val().length&&(e.url=m.val()),b.prop("checked")&&(e.allDay=!0),E.addEvent(e),E.refetchEvents())}),s.on("click",function(){if(i.valid()){for(var e={id:r.id,title:o.find(v).val(),start:o.find(u).val(),end:o.find(h).val(),url:m.val(),extendedProps:{location:g.val(),guests:f.val(),calendar:p.val(),description:x.val()},display:"block",allDay:!!b.prop("checked")},t=["id","title","url"],a=["calendar","guests","location","description"],n=E.getEventById(e.id),l=0;l<t.length;l++){var d=t[l];n.setProp(d,e[d])}for(n.setDates(e.start,e.end,{allDay:e.allDay}),l=0;l<a.length;l++)n.setExtendedProp(d=a[l],e.extendedProps[d]);o.modal("hide")}}),o.on("hidden.bs.modal",function(){M()}),$(".btn-toggle-sidebar").on("click",function(){w.addClass("d-none"),s.addClass("d-none"),l.removeClass("d-none"),$(".app-calendar-sidebar, .body-content-overlay").removeClass("show")}),y.length&&y.on("change",function(){$(this).prop("checked")?k.find("input").prop("checked",!0):k.find("input").prop("checked",!1),E.refetchEvents()}),C.length&&C.on("change",function(){$(".input-filter:checked").length<k.find("input").length?y.prop("checked",!1):y.prop("checked",!0),E.refetchEvents()})});